<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raving About Comics - View Comic</title>
    <link rel="stylesheet" type="text/css" href="/mainStyles.css">
    <link rel="stylesheet" type="text/css" href="/comicPageStyles.css">
    <link rel="stylesheet" type="text/css" href="/smallComicCardStyle.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
    <script type="text/babel">


        const handleGETRequest = (xhr) =>{

            const comic = JSON.parse(xhr.response);

            const imgContainer = document.querySelector('#coverImageContainer')
            const titleInfo = document.querySelector('#titleInfo')
            const authorInfo = document.querySelector('#authorInfo')
            const publisherInfo = document.querySelector('#publisherInfo')
            const totalInfo = document.querySelector('#totalInfo')

            const image = document.createElement('img');
            image.src = comic.imgURL;
            image.alt = comic.title;

            titleInfo.textContent = comic.title;
            authorInfo.textContent = comic.author;
            publisherInfo.textContent = comic.publisher;
            totalInfo.textContent = comic.totalScore;

            imgContainer.appendChild(image);
        };

        const getData = () =>{
            const queryString = window.location.search;

            const params = new URLSearchParams(queryString);
            
            const title = params.get('title').replace("%20", " ");

            const xhr = new XMLHttpRequest();

            const url = `/getComics?type=single&title=${title}`;
            xhr.open('GET', url);
            xhr.setRequestHeader('Accept', 'application/json');

            xhr.onload = () => handleGETRequest(xhr);
            xhr.send();

            return false;


        };

        const init = () =>{
            getData();
        };

        window.onload = init;

    </script>
</head>
<header>

    <section id="topBar">
        <!--<button id="login">Login</button>-->
        <h1 id="title">Raving About Comics</h1>
        <h4>Whether Raving Mad or Raving Glad, Let's Talk About Some Graphic Novels.</h4>
        

    </section>

</header>
<body>
    <div id="mainBodyContent">
        <div id="sideNavBar">
            <a href="/index.html">Home</a>
            <a href="/comicsList.html">Comics List</a>
            <a href="/index.html">Reading List</a>
            <a href="/index.html">My Reviews</a>
    
            <div id="copyright">
                <p>&copy;Joshua Fredrickson 2020</p>
            </div>
    
        </div>
        <div class="contentBody">
            <!--Add Data here
                
            -->

            <div id="comicInfo">

                <div id="coverImageContainer">

                </div>
    
                <div id="information">
                    <h2 class="infoLabel">Title: </h2>
                    <h2 class="info" id="titleInfo"></h2>
                    <h2 class="infoLabel">Author: </h2>
                    <h2 class="info" id="authorInfo"></h2>
                    <h2 class="infoLabel">Publisher: </h2>
                    <h2 class="info" id="publisherInfo"></h2>
                    <h2 class="infoLabel">Total Rating: </h2>
                    <h2 class="info" id="totalInfo"></h2>
                </div>
            </div>

            <div id="reviewsBox">

            </div>

    
        </div>
    </div>

    
</body>
</html>